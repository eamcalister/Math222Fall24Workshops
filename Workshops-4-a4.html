<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Integrals with Computers</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Math-222 Workshops - Fall 2024">
<meta property="book:author" content="Erich McAlister">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math"
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/themes/prism.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.css" integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.css" integrity="sha512-nXlJLUeqPMp1Q3+Bd8Qds8tXeRVQscMscwysJm821C++9w6WtsFbJjPenZ8cQVMXyqSAismveQJc0C1splFDCA==" crossorigin="anonymous" referrerpolicy="no-referrer">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><link href="_static/pretext/css/pretext_search.css" rel="stylesheet" type="text/css">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
<link href="_static/pretext/css/pretext.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/shell_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/banner_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/navbar_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/toc_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/knowls_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/style_default.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/setcolors.css" rel="stylesheet" type="text/css">
<style>
#Workshops-3-3-1 { counter-set: Workshops-3-3-1 0; }
#Workshops-3-3-1 > li::marker { content: "("counter(Workshops-3-3-1,lower-alpha)")"; }
#Workshops-3-3-1 > li { counter-increment: Workshops-3-3-1; }
#Workshops-3-4-5 { counter-set: Workshops-3-4-5 0; }
#Workshops-3-4-5 > li::marker { content: "("counter(Workshops-3-4-5,lower-alpha)")"; }
#Workshops-3-4-5 > li { counter-increment: Workshops-3-4-5; }
#Workshops-3-5-3 { counter-set: Workshops-3-5-3 0; }
#Workshops-3-5-3 > li::marker { content: "("counter(Workshops-3-5-3,lower-alpha)")"; }
#Workshops-3-5-3 > li { counter-increment: Workshops-3-5-3; }
#Workshops-3-7-3 { counter-set: Workshops-3-7-3 0; }
#Workshops-3-7-3 > li::marker { content: "("counter(Workshops-3-7-3,lower-alpha)")"; }
#Workshops-3-7-3 > li { counter-increment: Workshops-3-7-3; }
#Workshops-4-3-1 { counter-set: Workshops-4-3-1 0; }
#Workshops-4-3-1 > li::marker { content: "("counter(Workshops-4-3-1,lower-alpha)")"; }
#Workshops-4-3-1 > li { counter-increment: Workshops-4-3-1; }
#numerical_methods-10-2-8 { counter-set: numerical_methods-10-2-8 0; }
#numerical_methods-10-2-8 > li::marker { content: ""counter(numerical_methods-10-2-8,decimal)"."; }
#numerical_methods-10-2-8 > li { counter-increment: numerical_methods-10-2-8; }
#exercises-3-1 { counter-set: exercises-3-1 0; }
#exercises-3-1 > li::marker { content: ""counter(exercises-3-1,decimal)"."; }
#exercises-3-1 > li { counter-increment: exercises-3-1; }
#exercises-4-1 { counter-set: exercises-4-1 0; }
#exercises-4-1 > li::marker { content: ""counter(exercises-4-1,decimal)"."; }
#exercises-4-1 > li { counter-increment: exercises-4-1; }
#Workshops-5-3-1 { counter-set: Workshops-5-3-1 0; }
#Workshops-5-3-1 > li::marker { content: "("counter(Workshops-5-3-1,lower-alpha)")"; }
#Workshops-5-3-1 > li { counter-increment: Workshops-5-3-1; }
#Workshops-5-4-2 { counter-set: Workshops-5-4-2 0; }
#Workshops-5-4-2 > li::marker { content: "("counter(Workshops-5-4-2,lower-alpha)")"; }
#Workshops-5-4-2 > li { counter-increment: Workshops-5-4-2; }
#Workshops-5-5-2 { counter-set: Workshops-5-5-2 0; }
#Workshops-5-5-2 > li::marker { content: "("counter(Workshops-5-5-2,lower-alpha)")"; }
#Workshops-5-5-2 > li { counter-increment: Workshops-5-5-2; }
#Workshops-6-3-1 { counter-set: Workshops-6-3-1 0; }
#Workshops-6-3-1 > li::marker { content: "("counter(Workshops-6-3-1,lower-alpha)")"; }
#Workshops-6-3-1 > li { counter-increment: Workshops-6-3-1; }
#Workshops-6-4-3 { counter-set: Workshops-6-4-3 0; }
#Workshops-6-4-3 > li::marker { content: "("counter(Workshops-6-4-3,lower-alpha)")"; }
#Workshops-6-4-3 > li { counter-increment: Workshops-6-4-3; }
#Workshops-6-5-3 { counter-set: Workshops-6-5-3 0; }
#Workshops-6-5-3 > li::marker { content: "("counter(Workshops-6-5-3,lower-alpha)")"; }
#Workshops-6-5-3 > li { counter-increment: Workshops-6-5-3; }
#Workshops-6-6-3-1 { counter-set: Workshops-6-6-3-1 0; }
#Workshops-6-6-3-1 > li::marker { content: "("counter(Workshops-6-6-3-1,lower-alpha)")"; }
#Workshops-6-6-3-1 > li { counter-increment: Workshops-6-6-3-1; }
#Workshops-7-7-1 { counter-set: Workshops-7-7-1 0; }
#Workshops-7-7-1 > li::marker { content: "("counter(Workshops-7-7-1,lower-alpha)")"; }
#Workshops-7-7-1 > li { counter-increment: Workshops-7-7-1; }
#Workshops-7-8-2 { counter-set: Workshops-7-8-2 0; }
#Workshops-7-8-2 > li::marker { content: "("counter(Workshops-7-8-2,lower-alpha)")"; }
#Workshops-7-8-2 > li { counter-increment: Workshops-7-8-2; }
</style>
</head>
<body id="changeme" class="pretext book ignore-math standalone worksheet a4">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="Math_222_Workshops_Fall24.html"><span class="title">Math-222 Workshops - Fall 2024</span></a></h1>
<p class="byline">Erich McAlister</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"></span><span class="treebuttons"><a class="previous-button button" href="Workshops-3.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="Workshops.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="Workshops-5.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2"><ul class="structural contains-active toc-item-list">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="frontmatter-2.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="frontmatter-3.html" class="internal"><span class="title">Instructions for Students</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="Workshops.html" class="internal"><span class="codenumber">1</span> <span class="title">The Workshops</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-worksheet"><div class="toc-title-box"><a href="Workshops-3.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Integrals and Kinetic Energy</span></a></div></li>
<li class="toc-item toc-worksheet active">
<div class="toc-title-box"><a href="Workshops-4.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Integrals with Computers</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="Workshops-4.html#symbolic_integration" class="internal"><span class="codenumber">1.2.1</span> <span class="title">Symbolic Integration</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="Workshops-4.html#numerical_methods" class="internal"><span class="codenumber">1.2.2</span> <span class="title">Numerical Methods</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="Workshops-4.html#exercises" class="internal"><span class="codenumber">1.2.3</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-worksheet"><div class="toc-title-box"><a href="Workshops-5.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Geometric Series Applications</span></a></div></li>
<li class="toc-item toc-worksheet"><div class="toc-title-box"><a href="Workshops-6.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Being Careful with Series</span></a></div></li>
<li class="toc-item toc-worksheet"><div class="toc-title-box"><a href="Workshops-7.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Taylor Polynomials and Numerical Integration</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content">
<button class="print-button" title="Print" onClick="window.print()"><span class="name">Print</span></button><section class="worksheet" id="Workshops-4"><h2 class="heading hide-type">
<span class="type">Worksheet</span><span class="space"> </span><span class="codenumber">1.2</span><span class="space"> </span><span class="title">Integrals with Computers</span><div class="print-links">
<a href="Workshops-4-a4.html" class="a4">A4</a><a href="Workshops-4-letter.html" class="us">US</a>
</div>
</h2>
<div class="para" id="Workshops-4-2">In this workshop we will:</div>
<article class="objectives goal-like" id="Workshops-4-3"><h3 class="heading"><span class="type">Objectives</span></h3>
<ol class="lower-alpha" id="Workshops-4-3-1">
<li id="Workshops-4-3-1-1"><div class="para" id="Workshops-4-3-1-1-1">learn to input symbolic functions into Python in order to differentiate and integrate them symbolically,</div></li>
<li id="Workshops-4-3-1-2"><div class="para" id="Workshops-4-3-1-2-1">use Python to apply our known numerical integration algorithms (with whatever number of subdivisions we choose) when necessary, and</div></li>
<li id="Workshops-4-3-1-3"><div class="para" id="Workshops-4-3-1-3-1">use error bounds for each numerical method to determine a definite integral within a given accuracy when an elementary antiderivative does not exist.</div></li>
</ol></article><div class="para" id="Workshops-4-4">Even though we have learned integration techniques for many integrals in this class, it is often the case that antiderivatives cannot be written in terms of familiar functions (the so called <em class="emphasis">elementary functions</em>, which are essentially all the ones you learn about in Precalculus). When elementary antiderivatives don’t exist (it’s not just that you can’t find them), one must turn to numerical approximation techniques to approximate definite integrals. We learned about these approximation techniques in class. They are very repetitive to do by hand, so we will program a computer to do them. In the process we will learn some Python using the Sympy and Numpy packages.</div>
<section class="section" id="symbolic_integration"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">1.2.1</span><span class="space"> </span><span class="title">Symbolic Integration</span>
</h3>
<div class="para" id="symbolic_integration-2">To do integrals and derivatives symbolically (i.e. to get a formulas), we use the Sympy package (Sympy is for symbolic calculations with Python). The following is straightforward to use.</div>
<div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">import sympy as sp

#define your variable as a symbol
x = sp.symbols('x')

#define your function
f = x**2

print(sp.integrate(f,x))
print(sp.diff(f,x))
</code></pre></div></section><section class="section" id="numerical_methods"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">1.2.2</span><span class="space"> </span><span class="title">Numerical Methods</span>
</h3>
<div class="para" id="numerical_methods-2">In this section we give a Python script for a right-hand Riemann sum using the Numpy package (Numpy is for numerical calculation vs. symbolic). You can find a Python script on Canvas that has this, as well as a left-hand Riemann sum and the midpoint rule. Since we know the trapezoid rule and Simpson’s rule are computed from these, that’s all we’ll code up right now.</div>
<div class="para" id="numerical_methods-3">The right-hand Riemann sum is below, with some further explanation for those who know some Python.</div>
<div class="code-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><pre class="program"><code class="language-none">import numpy as np


#right-hand Riemann sum
def right_hand_rule(f,a,b,n): #a and b are the endpoints and n is the number of rectangles
	x = np.linspace(a,b,n+1) #this creates the set of n+1 evenly spaced points starting at a and ending at b.
	y = f(x)
	h = (b-a)/n
	integral = h*np.sum(y[1:n+1])
	return integral


#### Don't Modify above this line.

#define function to integrate
def f(x):
	return x**2 #change this function as needed

#Give the endpoints and number of sub-intervals
a = 0
b = 2
n = 3

print(right_hand_rule(f,a,b,n))
</code></pre></div>
<div class="para logical" id="numerical_methods-5">
<div class="para">In order for numerical integration rules (RIGHT, LEFT, MID, TRAP, and SIMP) to really be useful in real-world situations, we need to answer the following related questions:</div>
<ul class="disc" id="numerical_methods-5-1">
<li id="numerical_methods-5-1-1"><div class="para" id="numerical_methods-5-1-1-1">For a given function, on a given interval, using one of the rules, how much does the error decrease as we increase <span class="process-math">\(n\)</span> and how large will <span class="process-math">\(n\)</span> need to be to make the error as small as we want?</div></li>
<li id="numerical_methods-5-1-2"><div class="para" id="numerical_methods-5-1-2-1">How much better are the ``better’’ rules than ones that are easier to compute?</div></li>
</ul>
</div>
<div class="para" id="numerical_methods-6">To begin answering these, fill in the following blanks using your understanding of RIGHT, LEFT, MID, and TRAP. Be sure you can explain each answer using a picture.</div>
<article class="assemblage assemblage-like" id="numerical_methods-7"><h4 class="heading"><span class="title">Relation of Methods to Derivatives.</span></h4>
<div class="para logical" id="numerical_methods-7-2"><ul class="disc" id="numerical_methods-7-2-1">
<li id="numerical_methods-7-2-1-1"><div class="para logical" id="numerical_methods-7-2-1-1-1">
<div class="para">If <span class="process-math">\(f'\gt 0\)</span> on <span class="process-math">\([a,b]\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\text{LEFT}(n)\leq \int_a^b f(x)\,dx \leq \text{RIGHT}(n).
\end{equation*}
</div>
</div></li>
<li id="numerical_methods-7-2-1-2"><div class="para logical" id="numerical_methods-7-2-1-2-1">
<div class="para">If <span class="process-math">\(f'\lt 0\)</span> on <span class="process-math">\([a,b]\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\text{RIGHT}(n)\leq \int_a^b f(x)\,dx \leq \text{LEFT}(n).
\end{equation*}
</div>
</div></li>
<li id="numerical_methods-7-2-1-3"><div class="para logical" id="numerical_methods-7-2-1-3-1">
<div class="para">If <span class="process-math">\(f''\gt 0\)</span> on <span class="process-math">\([a,b]\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\text{MID}(n)\leq \int_a^b f(x)\,dx \leq \text{TRAP}(n).
\end{equation*}
</div>
</div></li>
<li id="numerical_methods-7-2-1-4"><div class="para logical" id="numerical_methods-7-2-1-4-1">
<div class="para">If <span class="process-math">\(f''\lt 0\)</span> on <span class="process-math">\([a,b]\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\text{TRAP}(n)\leq \int_a^b f(x)\,dx \leq \text{LEFT}(n).
\end{equation*}
</div>
</div></li>
</ul></div></article><div class="para" id="numerical_methods-8">So we see that error in LEFT and RIGHT depends somehow on the first derivative, while the error in MID and TRAP depends somehow on the second. The following list of numerical error bounds can be derived using material from section 10.4 of the text and/or integration by parts. However, it would be fairly time consuming to derive them, so we will instead focus on their use.</div>
<article class="assemblage assemblage-like" id="numerical_methods-9"><h4 class="heading"><span class="title">Error Bounds for Numerical Integration Methods.</span></h4>
<div class="para logical" id="numerical_methods-9-2"><ul class="disc" id="numerical_methods-9-2-1">
<li id="numerical_methods-9-2-1-1">
<span class="heading"><span class="title">Left and Right Error Bounds.</span></span><div class="para logical" id="numerical_methods-9-2-1-1-2">
<div class="para">If <span class="process-math">\(|f'(x)|\leq M\)</span> for all <span class="process-math">\(a\leq x\leq b\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{LEFT}(n) - \int_a^{b} f(x)\, dx\right| \leq \frac{M(b-a)^2}{2n}
\end{equation*}
</div>
<div class="para">and</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{RIGHT}(n) - \int_a^{b} f(x)\, dx\right| \leq \frac{M(b-a)^2}{2n}.
\end{equation*}
</div>
</div>
</li>
<li id="numerical_methods-9-2-1-2">
<span class="heading"><span class="title">Trap and Mid Error Bounds.</span></span><div class="para logical" id="numerical_methods-9-2-1-2-2">
<div class="para">If <span class="process-math">\(|f''(x)|\leq M\)</span> for all <span class="process-math">\(a\leq x\leq b\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{TRAP}(n) - \int_a^{b} f(x)\, dx\right| \leq \frac{M(b-a)^3}{12n^2}
\end{equation*}
</div>
<div class="para">and</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{MID}(n) - \int_a^{b} f(x)\, dx\right| \leq \frac{M(b-a)^3}{24n^3}.
\end{equation*}
</div>
</div>
</li>
<li id="numerical_methods-9-2-1-3">
<span class="heading"><span class="title">Simpson’s Rule Bound.</span></span><div class="para logical" id="numerical_methods-9-2-1-3-2">
<div class="para">If <span class="process-math">\(|f^(4)(x)|\leq M\)</span> for all <span class="process-math">\(a\leq x\leq b\text{,}\)</span> then</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{SIMP}(n) - \int_a^{b} f(x)\, dx\right| \leq \frac{M(b-a)^5}{2880n^4}
\end{equation*}
</div>
</div>
</li>
</ul></div></article><details id="numerical_methods-10" class="example example-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">1.2.1</span><span class="period">.</span><span class="space"> </span><span class="title">Using the Error Bound Formulas.</span>
</h4></summary><article class="example example-like knowl__content"> <div class="para logical" id="numerical_methods-10-2">
<div class="para">Suppose we want to numerically integrate <span class="process-math">\(f(x) = e^x\)</span> from <span class="process-math">\(x=0\)</span> to <span class="process-math">\(x=1\text{.}\)</span> We know the exact answer is <span class="process-math">\(\int_0^1 e^x dx = e-1\text{.}\)</span> However, maybe we don’t know the exact value of <span class="process-math">\(e\)</span> (we know it’s less than <span class="process-math">\(3\text{,}\)</span> but not much else), that may not be useful. Let’s use <span class="process-math">\(n=2\)</span> rectangles and estimate the error for each method. To do this we must:</div>
<ol class="decimal" id="numerical_methods-10-2-8">
<li id="numerical_methods-10-2-8-1"><div class="para" id="numerical_methods-10-2-8-1-1">Find the upper bound on the appropriate derivative for <span class="process-math">\(f(x)\text{.}\)</span> Since the derivative of <span class="process-math">\(e^x\)</span> is <span class="process-math">\(e^x\text{,}\)</span> we can say <span class="process-math">\(f^(n)(x)\leq 3\)</span> when <span class="process-math">\(0\leq x\leq 1\text{.}\)</span> That is, <span class="process-math">\(M = 3\)</span> for all the methods.</div></li>
<li id="numerical_methods-10-2-8-2"><div class="para" id="numerical_methods-10-2-8-2-1">Now plug into each formula to estimate possible errors with <span class="process-math">\(n=2\text{.}\)</span>
</div></li>
</ol>
</div> <div class="para logical" id="numerical_methods-10-3">
<div class="para">We get the following:</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{LEFT}(n) - \int_0^{1} e^x\, dx\right| \leq \frac{3(1-0)^2}{2\cdot 2} = \frac{3}{4}
\end{equation*}
</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{RIGHT}(n) - \int_0^{1} e^x\, dx\right| \leq \frac{3(1-0)^2}{2\cdot 2} = \frac{3}{4}
\end{equation*}
</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{TRAP}(n) - \int_0^{1} e^x\, dx\right| \leq \frac{3(1-0)^3}{12\cdot 2^2} = \frac{3}{48}
\end{equation*}
</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{MID}(n) - \int_0^{1} e^x\, dx\right| \leq \frac{3(1-0)^3}{24\cdot 2^2} = \frac{3}{96}
\end{equation*}
</div>
<div class="displaymath process-math">
\begin{equation*}
\left|\mbox{SIMP}(n) - \int_0^{1} e^x\, dx\right| \leq \frac{3(1-0)^5}{2880\cdot 2^4} = \frac{3}{46080}
\end{equation*}
</div>
</div> <div class="para logical" id="numerical_methods-10-4">
<div class="para">This means the error using Simpson’s Rule with just two rectangles will be less than or equal to <span class="process-math">\(0.0000652\text{.}\)</span> If we apply Simpson’s rule to this integral with <span class="process-math">\(n=2\text{,}\)</span> we get</div>
<div class="displaymath process-math">
\begin{equation*}
\int_0^1 e^x dx \approx \text{SIMP}(n) = 1.7183188419217472
\end{equation*}
</div>
<div class="para">The value of <span class="process-math">\(e-1\)</span> given by a calculator is <span class="process-math">\(1.718281828\text{.}\)</span> The actual error turns out to be about <span class="process-math">\(0.000037\text{,}\)</span> which is less than the bound.</div>
</div> If we wanted to know how big <span class="process-math">\(n\)</span> needs to be to get <span class="process-math">\(\text{TRAP}(n)\)</span> to be within <span class="process-math">\(6\cdot 10^{-5}\)</span> of the exact value, we would solve<div class="displaymath process-math">
\begin{equation*}
\frac{3(1-0)^3}{12n^2} \lt 0.00006
\end{equation*}
</div>and get <span class="process-math">\(n \gt \sqrt{\frac{10^6}{24}}\text{.}\)</span> This rounds up to <span class="process-math">\(65\text{.}\)</span> So, if <span class="process-math">\(n\geq 65\text{,}\)</span> <span class="process-math">\(\text{TRAP}(n)\)</span> will give as good an estimate as <span class="process-math">\(\text{SIMP}(2)\text{.}\)</span></article></details></section><section class="section" id="exercises"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">1.2.3</span><span class="space"> </span><span class="title">Exercises</span>
</h3>
<div class="para logical" id="exercises-2">
<div class="para">For these exercises, we will be considering the definite integral</div>
<div class="displaymath process-math">
\begin{equation*}
\int_{1}^{2} \frac{x}{e^{x}-1}\,dx.
\end{equation*}
</div>
</div>
<article class="exercise exercise-like" id="exercises-3"><h4 class="heading"><span class="codenumber">1<span class="period">.</span></span></h4>
<ol class="decimal" id="exercises-3-1">
<li id="exercises-3-1-1"><div class="para" id="exercises-3-1-1-1">(2 points) Describe where you get stuck doing this integral by hand.</div></li>
<li id="exercises-3-1-2"><div class="para" id="exercises-3-1-2-1">(2 points) What does Python give you for an antiderivative of <span class="process-math">\(\dfrac{x}{e^{x}-1}\)</span> (enter <code class="code-inline tex2jax_ignore">sp.exp(x)</code> for <span class="process-math">\(e^{x}\)</span>)? Is it useful (to you)?</div></li>
</ol></article><article class="exercise exercise-like" id="exercises-4"><h4 class="heading"><span class="codenumber">2<span class="period">.</span></span></h4>
<ol class="decimal" id="exercises-4-1">
<li id="exercises-4-1-1"><div class="para" id="exercises-4-1-1-1">(6 points)  Use a graph of the derivative of <span class="process-math">\(\dfrac{x}{e^{x}-1}\)</span> to help you find <span class="process-math">\(n\)</span> so that the LEFT and RIGHT approximation of this integral is within <span class="process-math">\(0.001\)</span> of the exact value. Find this approximation. Include a printout of the graph of the derivative of <span class="process-math">\(\dfrac{x}{e^{x}-1}\)</span> in your write-up.</div></li>
<li id="exercises-4-1-2"><div class="para" id="exercises-4-1-2-1">(6 points) Using the <span class="process-math">\(n\)</span> you found in (2a), what do the other methods give as approximations. What is the maximum possible error for each method of approximation? Include any relevant graphs to show how you arrived at your error bounds.</div></li>
<li id="exercises-4-1-3"><div class="para" id="exercises-4-1-3-1">(6 points) For each of MID, TRAP, and SIMP, how large must $n$ be to make the approximation within <span class="process-math">\(0.001\)</span> of the exact value of this integral? Be sure to explain your reasoning.</div></li>
</ol></article></section></section>
</div>
<div class="ptx-content-footer">
<a class="previous-button button" href="Workshops-3.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="Workshops-5.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
